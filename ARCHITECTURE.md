## Timeline Calendar Card - Project Structure

This is a TDD-first Home Assistant Lovelace card built with **Lit** (modern web components) and **TypeScript**.

### Architecture

```
src/
├── types.ts                    # Type definitions (CalendarEvent, Config, HomeAssistant)
├── test-data.ts               # Dummy event generator for testing
├── layout.ts                   # Masonry layout calculation logic
├── utils.ts                    # Utility functions (gradient, time formatting)
├── timeline-component.ts       # Core timeline UI component (Web Component)
├── timeline-calendar-card.ts   # Home Assistant custom card wrapper
├── index.ts                    # Main export
└── __tests__/                  # Jest test suites
    ├── test-data.test.ts       # Tests for dummy event generation
    ├── layout.test.ts          # Tests for masonry layout algorithm
    └── utils.test.ts           # Tests for utility functions

dist/                           # Compiled JavaScript (generated by tsc)
```

### Design Principles

1. **Test-Driven Development**: All core logic has tests before implementation
2. **Separation of Concerns**: 
   - `layout.ts` - Pure layout calculation (no DOM)
   - `utils.ts` - Pure utility functions
   - `timeline-component.ts` - UI component logic
   - `timeline-calendar-card.ts` - Home Assistant integration

3. **Masonry Layout**: Overlapping events are placed in separate columns automatically

### Key Features Implemented

✅ 24-hour timeline (starting 2 AM)
✅ Masonry-style overlapping event handling
✅ Time gradient background (day/night cycle)
✅ Dummy event data generator
✅ Comprehensive test coverage (15 passing tests)
✅ TypeScript for type safety
✅ Lit web component framework

### Event Data Structure

```typescript
interface CalendarEvent {
  id: string;
  title: string;
  start: Date;
  end: Date;
  calendar: string;
  color?: string;
}
```

### Dummy Events Generated

The test data generator creates a realistic single-day scenario:
- Morning Standup: 2:00-2:30 AM
- Team Meeting: 2:15-3:15 AM (overlaps with standup)
- Lunch: 12:00-1:00 PM
- Project Work: 1:00-3:30 PM
- Dentist: 2:00-2:30 PM (overlaps with project work)
- Gym: 5:00-6:00 PM

### Build & Development

```bash
# Install dependencies
npm install

# Compile TypeScript
npm run build

# Watch for changes during development
npm run dev

# Run tests
npm test
npm run test:watch
```

### Next Steps

1. **Connect to caldav integration** - Replace dummy events with real calendar data
2. **Add configuration UI** - Allow users to select which calendars to display
3. **Handle narrow screens** - Implement responsive layout for mobile/tablet
4. **Add event details** - Show time, duration, and other metadata on hover
5. **Support event interactions** - Click to open event details or edit
6. **Timezone support** - Handle user's timezone settings
7. **Performance optimization** - Lazy load events, virtualize long timelines

### Installation in Home Assistant

1. Copy `dist/timeline-calendar-card.js` to `config/www/`
2. Add resource to dashboard:
   ```yaml
   resources:
     - url: /local/timeline-calendar-card.js
       type: module
   ```
3. Add card to dashboard:
   ```yaml
   type: custom:timeline-calendar
   calendars:
     - calendar.my_calendar
     - calendar.work_calendar
   ```

### Test Results

All 15 tests passing:
- ✓ Dummy event generation (5 tests)
- ✓ Masonry layout algorithm (5 tests)
- ✓ Utility functions (5 tests)
